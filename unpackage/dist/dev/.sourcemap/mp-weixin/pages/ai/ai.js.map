{"version":3,"file":"ai.js","sources":["pages/ai/ai.vue","../../../HBuilderX/HBuilderX.4.76.2025082103/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYWkvYWkudnVl"],"sourcesContent":["<template>\r\n\t<view class=\"ai-page\">\r\n\t\t<!-- é¡¶éƒ¨åŠŸèƒ½åŒº -->\r\n\t\t<view class=\"top-bar\">\r\n\t\t\t<view class=\"virtual-human-btn\" @click=\"showVirtualHumanPreview\">\r\n\t\t\t\t<text class=\"virtual-icon\">ğŸ­</text>\r\n\t\t\t\t<text class=\"virtual-text\">è™šæ‹Ÿäºº</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"current-settings\">\r\n\t\t\t\t<text class=\"settings-text\">å½“å‰ï¼š{{currentRole.name}} Â· {{currentStyle.name}}</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"conversation-actions\">\r\n\t\t\t\t<view class=\"new-conversation-btn\" @click=\"createNewConversation\">\r\n\t\t\t\t\t<text class=\"action-icon\">â•</text>\r\n\t\t\t\t\t<text class=\"action-text\">æ–°å¯¹è¯</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"history-btn\" @click=\"toggleHistoryPanel\">\r\n\t\t\t\t\t<text class=\"action-icon\">ğŸ“š</text>\r\n\t\t\t\t\t<text class=\"action-text\">å†å²è®°å½•</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- è§’è‰²é€‰æ‹©åŒº -->\r\n\t\t<view class=\"role-section\">\r\n\t\t\t<text class=\"section-title\">é€‰æ‹©AIè§’è‰²</text>\r\n\t\t\t<scroll-view class=\"role-list\" scroll-x=\"true\" show-scrollbar=\"false\" enable-flex>\r\n\t\t\t\t<view class=\"role-item\" v-for=\"role in roles\" :key=\"role.id\"\r\n\t\t\t\t\t:class=\"{active: currentRole.id === role.id}\"\r\n\t\t\t\t\t@click=\"selectRole(role.id)\">\r\n\t\t\t\t\t<text class=\"role-icon\">{{role.icon}}</text>\r\n\t\t\t\t\t<text class=\"role-name\">{{role.name}}</text>\r\n\t\t\t\t\t<text class=\"role-desc\">{{role.description}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</scroll-view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- é£æ ¼è®¾ç½®åŒº -->\r\n\t\t<view class=\"style-section\">\r\n\t\t\t<text class=\"section-title\">å›å¤é£æ ¼</text>\r\n\t\t\t<view class=\"style-tags\">\r\n\t\t\t\t<view class=\"style-tag\" v-for=\"style in styles\" :key=\"style.id\"\r\n\t\t\t\t\t:class=\"{active: currentStyle.id === style.id}\"\r\n\t\t\t\t\t@click=\"selectStyle(style.id)\">\r\n\t\t\t\t\t<text class=\"style-icon\">{{style.icon}}</text>\r\n\t\t\t\t\t<text class=\"style-name\">{{style.name}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- èŠå¤©ä¸»ç•Œé¢ -->\r\n\t\t<view class=\"chat-container\">\r\n\t\t\t<scroll-view class=\"message-list\" scroll-y=\"true\" :scroll-top=\"scrollTop\" enable-flex>\r\n\t\t\t\t<view class=\"message-item\" v-for=\"(msg, index) in messages\" :key=\"index\" \r\n\t\t\t\t\t:class=\"{'user-message': msg.role === 'user', 'ai-message': msg.role === 'assistant'}\">\r\n\t\t\t\t\t<view class=\"avatar\">\r\n\t\t\t\t\t\t<text v-if=\"msg.role === 'user'\">ğŸ‘¤</text>\r\n\t\t\t\t\t\t<text v-else>{{currentRole.icon}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"content\">\r\n\t\t\t\t\t\t<text>{{msg.content}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<!-- åŠ è½½çŠ¶æ€ -->\r\n\t\t\t\t<view class=\"message-item ai-message\" v-if=\"isLoading\">\r\n\t\t\t\t\t<view class=\"avatar\">\r\n\t\t\t\t\t\t<text>{{currentRole.icon}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"content\">\r\n\t\t\t\t\t\t<view class=\"loading-dots\">\r\n\t\t\t\t\t\t\t<text class=\"dot\">.</text>\r\n\t\t\t\t\t\t\t<text class=\"dot\">.</text>\r\n\t\t\t\t\t\t\t<text class=\"dot\">.</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</scroll-view>\r\n\t\t\t\r\n\t\t\t<view class=\"input-area\">\r\n\t\t\t\t<input class=\"input\" v-model=\"inputText\" placeholder=\"å’ŒAIä¼™ä¼´èŠèŠ...\" @confirm=\"sendMessage\" />\r\n\t\t\t\t<button class=\"send-btn\" @click=\"sendMessage\">å‘é€</button>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- è™šæ‹ŸäººåŠŸèƒ½é¢„è§ˆå¼¹çª— -->\r\n\t\t<view class=\"modal\" v-if=\"showVirtualHumanModal\">\r\n\t\t\t<view class=\"modal-content\">\r\n\t\t\t\t<view class=\"modal-header\">\r\n\t\t\t\t\t<text class=\"modal-title\">è™šæ‹ŸäººåŠŸèƒ½</text>\r\n\t\t\t\t\t<text class=\"modal-close\" @click=\"closeVirtualHumanModal\">Ã—</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"modal-body\">\r\n\t\t\t\t\t<text class=\"modal-text\">è™šæ‹ŸäººåŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­ï¼Œå³å°†æ¨å‡ºï¼</text>\r\n\t\t\t\t\t<text class=\"modal-text\">æœªæ¥æ‚¨å°†å¯ä»¥ä¸è™šæ‹Ÿå½¢è±¡è¿›è¡Œæ›´ç”ŸåŠ¨çš„å¯¹è¯äº¤æµã€‚</text>\r\n\t\t\t\t\t<view class=\"feature-preview\">\r\n\t\t\t\t\t\t<text class=\"feature-item\">ğŸ¯ ä¸ªæ€§åŒ–è™šæ‹Ÿå½¢è±¡</text>\r\n\t\t\t\t\t\t<text class=\"feature-item\">ğŸ’¬ è¡¨æƒ…ä¸°å¯Œçš„å¯¹è¯</text>\r\n\t\t\t\t\t\t<text class=\"feature-item\">ğŸ¨ è‡ªå®šä¹‰å¤–è§‚</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- å†å²è®°å½•é¢æ¿ -->\r\n\t\t<view class=\"history-panel\" :class=\"{active: showHistoryPanel}\">\r\n\t\t\t<view class=\"history-header\">\r\n\t\t\t\t<text class=\"history-title\">å¯¹è¯å†å²</text>\r\n\t\t\t\t<view class=\"history-stats\">\r\n\t\t\t\t\t<text class=\"stat-item\">æ€»è®¡: {{conversationStats.total}}</text>\r\n\t\t\t\t\t<text class=\"stat-item\">æœ€è¿‘: {{conversationStats.recent}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<text class=\"history-close\" @click=\"toggleHistoryPanel\">Ã—</text>\r\n\t\t\t</view>\r\n\t\t\t<scroll-view class=\"history-list\" scroll-y=\"true\">\r\n\t\t\t\t<view class=\"history-item\" \r\n\t\t\t\t\tv-for=\"conversation in conversations\" \r\n\t\t\t\t\t:key=\"conversation.id\"\r\n\t\t\t\t\t:class=\"{active: currentConversationId === conversation.id}\"\r\n\t\t\t\t\t@click=\"loadConversation(conversation.id)\">\r\n\t\t\t\t\t<view class=\"conversation-info\">\r\n\t\t\t\t\t\t<text class=\"conversation-title\">{{conversation.title}}</text>\r\n\t\t\t\t\t\t<text class=\"conversation-meta\">\r\n\t\t\t\t\t\t\t{{formatDate(conversation.updated_at)}} Â· \r\n\t\t\t\t\t\t\t{{getRoleName(conversation.role_id)}} Â· \r\n\t\t\t\t\t\t\t{{getStyleName(conversation.style_id)}}\r\n\t\t\t\t\t\t</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"conversation-actions\">\r\n\t\t\t\t\t\t<text class=\"action-btn delete-btn\" @click.stop=\"deleteConversation(conversation.id)\">ğŸ—‘ï¸</text>\r\n\t\t\t\t\t\t<text class=\"action-btn edit-btn\" @click.stop=\"editConversationTitle(conversation)\">âœï¸</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"empty-state\" v-if=\"conversations.length === 0\">\r\n\t\t\t\t\t<text class=\"empty-icon\">ğŸ“</text>\r\n\t\t\t\t\t<text class=\"empty-text\">è¿˜æ²¡æœ‰å¯¹è¯è®°å½•</text>\r\n\t\t\t\t\t<text class=\"empty-hint\">å¼€å§‹æ–°çš„å¯¹è¯å§ï¼</text>\r\n\t\t\t\t</view>\r\n\t\t\t</scroll-view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- é®ç½©å±‚ -->\r\n\t\t<view class=\"overlay\" v-if=\"showHistoryPanel\" @click=\"toggleHistoryPanel\"></view>\r\n\t\t\r\n\t\t<!-- ç¼–è¾‘æ ‡é¢˜å¼¹çª— -->\r\n\t\t<view class=\"modal\" v-if=\"showEditTitleModal\">\r\n\t\t\t<view class=\"modal-content\">\r\n\t\t\t\t<view class=\"modal-header\">\r\n\t\t\t\t\t<text class=\"modal-title\">ç¼–è¾‘å¯¹è¯æ ‡é¢˜</text>\r\n\t\t\t\t\t<text class=\"modal-close\" @click=\"closeEditTitleModal\">Ã—</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"modal-body\">\r\n\t\t\t\t\t<input class=\"title-input\" v-model=\"editingTitle\" placeholder=\"è¯·è¾“å…¥å¯¹è¯æ ‡é¢˜\" />\r\n\t\t\t\t\t<view class=\"modal-actions\">\r\n\t\t\t\t\t\t<button class=\"btn-cancel\" @click=\"closeEditTitleModal\">å–æ¶ˆ</button>\r\n\t\t\t\t\t\t<button class=\"btn-confirm\" @click=\"confirmEditTitle\">ç¡®å®š</button>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport conversationService from '@/utils/supabase.js'\r\n\t\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tinputText: '',\r\n\t\t\t\tmessages: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\trole: 'assistant',\r\n\t\t\t\t\t\tcontent: 'ä½ å¥½ï¼æˆ‘æ˜¯ä½ çš„AIå¿ƒç†ä¼™ä¼´ï¼Œéšæ—¶å‡†å¤‡å€¾å¬ä½ çš„å¿ƒå£°ã€‚ä»Šå¤©è¿‡å¾—æ€ä¹ˆæ ·ï¼Ÿ'\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t\tscrollTop: 0,\r\n\t\t\t\tshowVirtualHumanModal: false,\r\n\t\t\t\tisLoading: false,\r\n\t\t\t\t\r\n\t\t\t\t// å¯¹è¯ç®¡ç†ç›¸å…³\r\n\t\t\t\tconversations: [],\r\n\t\t\t\tcurrentConversationId: null,\r\n\t\t\t\tshowHistoryPanel: false,\r\n\t\t\t\tshowEditTitleModal: false,\r\n\t\t\t\teditingConversation: null,\r\n\t\t\t\teditingTitle: '',\r\n\t\t\t\tconversationStats: {\r\n\t\t\t\t\ttotal: 0,\r\n\t\t\t\t\trecent: 0\r\n\t\t\t\t},\r\n\t\t\t\t\r\n\t\t\t\t// Dify APIé…ç½®\r\n\t\t\t\tdifyConfig: {\r\n\t\t\t\t\tapiKey: 'app-VlvTWUWxlfDZhLgTIVuGj22t',\r\n\t\t\t\t\tapiUrl: 'https://dify.aipfuture.com/v1',\r\n\t\t\t\t\tendpoint: '/chat-messages'\r\n\t\t\t\t},\r\n\t\t\t\t\r\n\t\t\t\t// è§’è‰²æ•°æ®\r\n\t\t\t\troles: [\r\n\t\t\t\t\t{ id: 'companion', name: 'å¿ƒçµä¼™ä¼´', icon: 'ğŸ’–', description: 'æ¸©æš–é™ªä¼´ï¼Œæƒ…æ„Ÿæ”¯æŒ' },\r\n\t\t\t\t\t{ id: 'advisor', name: 'ä¸“ä¸šé¡¾é—®', icon: 'ğŸ“', description: 'ä¸“ä¸šåˆ†æï¼Œç†æ€§å»ºè®®' }\r\n\t\t\t\t],\r\n\t\t\t\t\r\n\t\t\t\t// é£æ ¼æ•°æ®\r\n\t\t\t\tstyles: [\r\n\t\t\t\t\t{ id: 'friendly', name: 'äº²åˆ‡å‹å¥½', icon: 'ğŸ˜Š' },\r\n\t\t\t\t\t{ id: 'professional', name: 'ä¸“ä¸šä¸¥è°¨', icon: 'ğŸ“Š' },\r\n\t\t\t\t\t{ id: 'encouraging', name: 'é¼“åŠ±æ”¯æŒ', icon: 'ğŸŒŸ' },\r\n\t\t\t\t\t{ id: 'casual', name: 'è½»æ¾éšæ„', icon: 'ğŸ˜„' }\r\n\t\t\t\t],\r\n\t\t\t\t\r\n\t\t\t\tcurrentRole: { id: 'companion', name: 'å¿ƒçµä¼™ä¼´', icon: 'ğŸ’–', description: 'æ¸©æš–é™ªä¼´ï¼Œæƒ…æ„Ÿæ”¯æŒ' },\r\n\t\t\t\tcurrentStyle: { id: 'friendly', name: 'äº²åˆ‡å‹å¥½', icon: 'ğŸ˜Š' }\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tmounted() {\r\n\t\t\t// ä»æœ¬åœ°å­˜å‚¨åŠ è½½ç”¨æˆ·åå¥½è®¾ç½®\r\n\t\t\tthis.loadUserPreferences()\r\n\t\t\t// åˆå§‹åŒ–å¯¹è¯ç³»ç»Ÿ\r\n\t\t\tthis.initConversationSystem()\r\n\t\t},\r\n\t\t\r\n\t\tmethods: {\r\n\t\t\t// åˆå§‹åŒ–å¯¹è¯ç³»ç»Ÿ\r\n\t\t\tasync initConversationSystem() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\t// æ£€æŸ¥Supabaseè¿æ¥\r\n\t\t\t\t\tawait conversationService.checkSupabaseConnection()\r\n\t\t\t\t\t\r\n\t\t\t\t\t// åŠ è½½å¯¹è¯åˆ—è¡¨\r\n\t\t\t\t\tawait this.loadConversations()\r\n\t\t\t\t\t\r\n\t\t\t\t\t// å¦‚æœæ²¡æœ‰å½“å‰å¯¹è¯ï¼Œåˆ›å»ºæ–°å¯¹è¯\r\n\t\t\t\t\tif (!this.currentConversationId && this.conversations.length === 0) {\r\n\t\t\t\t\t\tawait this.createNewConversation()\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// åŠ è½½ç»Ÿè®¡ä¿¡æ¯\r\n\t\t\t\t\tawait this.loadConversationStats()\r\n\t\t\t\t\t\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('åˆå§‹åŒ–å¯¹è¯ç³»ç»Ÿå¤±è´¥:', error)\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: 'å¯¹è¯ç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥',\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// åŠ è½½å¯¹è¯åˆ—è¡¨\r\n\t\t\tasync loadConversations() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tthis.conversations = await conversationService.getUserConversations()\r\n\t\t\t\t\t// æŒ‰æ›´æ–°æ—¶é—´å€’åºæ’åˆ—\r\n\t\t\t\t\tthis.conversations.sort((a, b) => new Date(b.updated_at) - new Date(a.updated_at))\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('åŠ è½½å¯¹è¯åˆ—è¡¨å¤±è´¥:', error)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// åŠ è½½ç»Ÿè®¡ä¿¡æ¯\r\n\t\t\tasync loadConversationStats() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tthis.conversationStats = await conversationService.getConversationStats()\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('åŠ è½½ç»Ÿè®¡ä¿¡æ¯å¤±è´¥:', error)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// åˆ›å»ºæ–°å¯¹è¯\r\n\t\t\tasync createNewConversation() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst title = `ä¸${this.currentRole.name}çš„å¯¹è¯`\r\n\t\t\t\t\tconst conversation = await conversationService.createConversation(\r\n\t\t\t\t\t\ttitle,\r\n\t\t\t\t\t\tthis.currentRole.id,\r\n\t\t\t\t\t\tthis.currentStyle.id\r\n\t\t\t\t\t)\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.currentConversationId = conversation.id\r\n\t\t\t\t\tthis.messages = [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\trole: 'assistant',\r\n\t\t\t\t\t\t\tcontent: 'ä½ å¥½ï¼æˆ‘æ˜¯ä½ çš„AIå¿ƒç†ä¼™ä¼´ï¼Œéšæ—¶å‡†å¤‡å€¾å¬ä½ çš„å¿ƒå£°ã€‚ä»Šå¤©è¿‡å¾—æ€ä¹ˆæ ·ï¼Ÿ'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]\r\n\t\t\t\t\t\r\n\t\t\t\t\t// é‡æ–°åŠ è½½å¯¹è¯åˆ—è¡¨\r\n\t\t\t\t\tawait this.loadConversations()\r\n\t\t\t\t\tawait this.loadConversationStats()\r\n\t\t\t\t\t\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: 'æ–°å¯¹è¯å·²åˆ›å»º',\r\n\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\tduration: 1500\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('åˆ›å»ºæ–°å¯¹è¯å¤±è´¥:', error)\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: 'åˆ›å»ºå¯¹è¯å¤±è´¥',\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// åŠ è½½å¯¹è¯\r\n\t\t\tasync loadConversation(conversationId) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tthis.currentConversationId = conversationId\r\n\t\t\t\t\t\r\n\t\t\t\t\t// è·å–å¯¹è¯æ¶ˆæ¯\r\n\t\t\t\t\tconst conversation = this.conversations.find(c => c.id === conversationId)\r\n\t\t\t\t\tif (conversation && conversation.messages) {\r\n\t\t\t\t\t\tthis.messages = conversation.messages\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// ä»æ•°æ®åº“åŠ è½½æ¶ˆæ¯\r\n\t\t\t\t\t\tconst messages = await conversationService.getConversationMessages(conversationId)\r\n\t\t\t\t\t\tthis.messages = messages\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// æ›´æ–°å½“å‰è§’è‰²å’Œé£æ ¼\r\n\t\t\t\t\tconst conversationData = this.conversations.find(c => c.id === conversationId)\r\n\t\t\t\t\tif (conversationData) {\r\n\t\t\t\t\t\tconst role = this.roles.find(r => r.id === conversationData.role_id)\r\n\t\t\t\t\t\tconst style = this.styles.find(s => s.id === conversationData.style_id)\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (role) this.currentRole = role\r\n\t\t\t\t\t\tif (style) this.currentStyle = style\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// å…³é—­å†å²é¢æ¿\r\n\t\t\t\t\tthis.showHistoryPanel = false\r\n\t\t\t\t\t\r\n\t\t\t\t\t// æ»šåŠ¨åˆ°åº•éƒ¨\r\n\t\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\t\tthis.scrollTop = 99999\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('åŠ è½½å¯¹è¯å¤±è´¥:', error)\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: 'åŠ è½½å¯¹è¯å¤±è´¥',\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// åˆ é™¤å¯¹è¯\r\n\t\t\tasync deleteConversation(conversationId) {\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: 'ç¡®è®¤åˆ é™¤',\r\n\t\t\t\t\tcontent: 'ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå¯¹è¯å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚',\r\n\t\t\t\t\tsuccess: async (res) => {\r\n\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\tawait conversationService.deleteConversation(conversationId)\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t// å¦‚æœåˆ é™¤çš„æ˜¯å½“å‰å¯¹è¯ï¼Œåˆ›å»ºæ–°å¯¹è¯\r\n\t\t\t\t\t\t\t\tif (this.currentConversationId === conversationId) {\r\n\t\t\t\t\t\t\t\t\tawait this.createNewConversation()\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t// é‡æ–°åŠ è½½å¯¹è¯åˆ—è¡¨\r\n\t\t\t\t\t\t\t\tawait this.loadConversations()\r\n\t\t\t\t\t\t\t\tawait this.loadConversationStats()\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: 'å¯¹è¯å·²åˆ é™¤',\r\n\t\t\t\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\t\t\t\tduration: 1500\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\t\t\tconsole.error('åˆ é™¤å¯¹è¯å¤±è´¥:', error)\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: 'åˆ é™¤å¤±è´¥',\r\n\t\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// ç¼–è¾‘å¯¹è¯æ ‡é¢˜\r\n\t\t\teditConversationTitle(conversation) {\r\n\t\t\t\tthis.editingConversation = conversation\r\n\t\t\t\tthis.editingTitle = conversation.title\r\n\t\t\t\tthis.showEditTitleModal = true\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// ç¡®è®¤ç¼–è¾‘æ ‡é¢˜\r\n\t\t\tasync confirmEditTitle() {\r\n\t\t\t\tif (!this.editingTitle.trim()) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: 'æ ‡é¢˜ä¸èƒ½ä¸ºç©º',\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\ttry {\r\n\t\t\t\t\tawait conversationService.updateConversationTitle(\r\n\t\t\t\t\t\tthis.editingConversation.id,\r\n\t\t\t\t\t\tthis.editingTitle\r\n\t\t\t\t\t)\r\n\t\t\t\t\t\r\n\t\t\t\t\t// æ›´æ–°æœ¬åœ°æ•°æ®\r\n\t\t\t\t\tconst index = this.conversations.findIndex(c => c.id === this.editingConversation.id)\r\n\t\t\t\t\tif (index >= 0) {\r\n\t\t\t\t\t\tthis.conversations[index].title = this.editingTitle\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.closeEditTitleModal()\r\n\t\t\t\t\t\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: 'æ ‡é¢˜å·²æ›´æ–°',\r\n\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\tduration: 1500\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('æ›´æ–°æ ‡é¢˜å¤±è´¥:', error)\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: 'æ›´æ–°å¤±è´¥',\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// å…³é—­ç¼–è¾‘æ ‡é¢˜å¼¹çª—\r\n\t\t\tcloseEditTitleModal() {\r\n\t\t\t\tthis.showEditTitleModal = false\r\n\t\t\t\tthis.editingConversation = null\r\n\t\t\t\tthis.editingTitle = ''\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// åˆ‡æ¢å†å²é¢æ¿\r\n\t\t\ttoggleHistoryPanel() {\r\n\t\t\t\tthis.showHistoryPanel = !this.showHistoryPanel\r\n\t\t\t\tif (this.showHistoryPanel) {\r\n\t\t\t\t\tthis.loadConversations()\r\n\t\t\t\t\tthis.loadConversationStats()\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// æ ¼å¼åŒ–æ—¥æœŸ\r\n\t\t\tformatDate(dateString) {\r\n\t\t\t\tconst date = new Date(dateString)\r\n\t\t\t\tconst now = new Date()\r\n\t\t\t\tconst diff = now - date\r\n\t\t\t\t\r\n\t\t\t\tif (diff < 24 * 60 * 60 * 1000) {\r\n\t\t\t\t\t// ä»Šå¤©\r\n\t\t\t\t\treturn date.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' })\r\n\t\t\t\t} else if (diff < 7 * 24 * 60 * 60 * 1000) {\r\n\t\t\t\t\t// ä¸€å‘¨å†…\r\n\t\t\t\t\tconst days = Math.floor(diff / (24 * 60 * 60 * 1000))\r\n\t\t\t\t\treturn `${days}å¤©å‰`\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// æ›´æ—©\r\n\t\t\t\t\treturn date.toLocaleDateString('zh-CN', { month: 'short', day: 'numeric' })\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// è·å–è§’è‰²åç§°\r\n\t\t\tgetRoleName(roleId) {\r\n\t\t\t\tconst role = this.roles.find(r => r.id === roleId)\r\n\t\t\t\treturn role ? role.name : 'æœªçŸ¥è§’è‰²'\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// è·å–é£æ ¼åç§°\r\n\t\t\tgetStyleName(styleId) {\r\n\t\t\t\tconst style = this.styles.find(s => s.id === styleId)\r\n\t\t\t\treturn style ? style.name : 'æœªçŸ¥é£æ ¼'\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// åŠ è½½ç”¨æˆ·åå¥½è®¾ç½®\r\n\t\t\tloadUserPreferences() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst savedRole = uni.getStorageSync('ai_role')\r\n\t\t\t\t\tconst savedStyle = uni.getStorageSync('ai_style')\r\n\t\t\t\t\t\r\n\t\t\t\t\t// ç¡®ä¿currentRoleå§‹ç»ˆæœ‰å€¼\r\n\t\t\t\t\tif (savedRole) {\r\n\t\t\t\t\t\tconst role = this.roles.find(r => r.id === savedRole)\r\n\t\t\t\t\t\tthis.currentRole = role || this.roles[0] // å¦‚æœæ‰¾ä¸åˆ°ï¼Œä½¿ç”¨é»˜è®¤è§’è‰²\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.currentRole = this.roles[0] // ä½¿ç”¨é»˜è®¤è§’è‰²\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// ç¡®ä¿currentStyleå§‹ç»ˆæœ‰å€¼\r\n\t\t\t\t\tif (savedStyle) {\r\n\t\t\t\t\t\tconst style = this.styles.find(s => s.id === savedStyle)\r\n\t\t\t\t\t\tthis.currentStyle = style || this.styles[0] // å¦‚æœæ‰¾ä¸åˆ°ï¼Œä½¿ç”¨é»˜è®¤é£æ ¼\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.currentStyle = this.styles[0] // ä½¿ç”¨é»˜è®¤é£æ ¼\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tconsole.log('åŠ è½½ç”¨æˆ·åå¥½å¤±è´¥', e)\r\n\t\t\t\t\t// è®¾ç½®é»˜è®¤å€¼\r\n\t\t\t\t\tthis.currentRole = this.roles[0]\r\n\t\t\t\t\tthis.currentStyle = this.styles[0]\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// é€‰æ‹©è§’è‰²\r\n\t\t\tselectRole(roleId) {\r\n\t\t\t\tconst role = this.roles.find(r => r.id === roleId)\r\n\t\t\t\tif (role) {\r\n\t\t\t\t\tthis.currentRole = role\r\n\t\t\t\t\tuni.setStorageSync('ai_role', roleId)\r\n\t\t\t\t\t\r\n\t\t\t\t\t// è§’è‰²åˆ‡æ¢åçš„é—®å€™è¯­\r\n\t\t\t\t\tthis.addRoleGreeting()\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// é€‰æ‹©é£æ ¼\r\n\t\t\tselectStyle(styleId) {\r\n\t\t\t\tconst style = this.styles.find(s => s.id === styleId)\r\n\t\t\t\tif (style) {\r\n\t\t\t\t\tthis.currentStyle = style\r\n\t\t\t\t\tuni.setStorageSync('ai_style', styleId)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// è§’è‰²åˆ‡æ¢é—®å€™è¯­\r\n\t\t\taddRoleGreeting() {\r\n\t\t\t\tconst greetings = {\r\n\t\t\t\t\tcompanion: 'ä½ å¥½ï¼æˆ‘æ˜¯ä½ çš„å¿ƒçµä¼™ä¼´ï¼Œæˆ‘ä¼šç”¨æ¸©æš–çš„å¿ƒå€¾å¬ä½ çš„æ¯ä¸€ä¸ªæ•…äº‹ã€‚æœ‰ä»€ä¹ˆæƒ³å’Œæˆ‘åˆ†äº«çš„å—ï¼Ÿ',\r\n\t\t\t\t\tadvisor: 'æ‚¨å¥½ï¼æˆ‘æ˜¯æ‚¨çš„ä¸“ä¸šå¿ƒç†é¡¾é—®ï¼Œæˆ‘å°†ç”¨ä¸“ä¸šçš„çŸ¥è¯†ä¸ºæ‚¨æä¾›ç†æ€§çš„åˆ†æå’Œå»ºè®®ã€‚è¯·å‘Šè¯‰æˆ‘æ‚¨çš„æƒ…å†µã€‚'\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tthis.messages.push({\r\n\t\t\t\t\trole: 'assistant',\r\n\t\t\t\t\tcontent: greetings[this.currentRole.id]\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\tthis.scrollTop = 99999\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// æ˜¾ç¤ºè™šæ‹ŸäººåŠŸèƒ½é¢„è§ˆ\r\n\t\t\tshowVirtualHumanPreview() {\r\n\t\t\t\tthis.showVirtualHumanModal = true\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// å…³é—­è™šæ‹ŸäººåŠŸèƒ½é¢„è§ˆ\r\n\t\t\tcloseVirtualHumanModal() {\r\n\t\t\t\tthis.showVirtualHumanModal = false\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tasync sendMessage() {\r\n\t\t\t\tif (!this.inputText.trim()) return\r\n\t\t\t\t\r\n\t\t\t\t// å¦‚æœæ²¡æœ‰å½“å‰å¯¹è¯ï¼Œå…ˆåˆ›å»º\r\n\t\t\t\tif (!this.currentConversationId) {\r\n\t\t\t\t\tawait this.createNewConversation()\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// æ·»åŠ ç”¨æˆ·æ¶ˆæ¯\r\n\t\t\t\tthis.messages.push({\r\n\t\t\t\t\trole: 'user',\r\n\t\t\t\t\tcontent: this.inputText\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\t// ä¿å­˜ç”¨æˆ·æ¶ˆæ¯åˆ°æ•°æ®åº“\r\n\t\t\t\ttry {\r\n\t\t\t\t\tawait conversationService.saveMessage(\r\n\t\t\t\t\t\tthis.currentConversationId,\r\n\t\t\t\t\t\t'user',\r\n\t\t\t\t\t\tthis.inputText\r\n\t\t\t\t\t)\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('ä¿å­˜ç”¨æˆ·æ¶ˆæ¯å¤±è´¥:', error)\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tconst userMessage = this.inputText\r\n\t\t\t\tthis.inputText = ''\r\n\t\t\t\tthis.isLoading = true\r\n\t\t\t\t\r\n\t\t\t\t// æ»šåŠ¨åˆ°æœ€æ–°æ¶ˆæ¯\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\tthis.scrollTop = 99999\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\ttry {\r\n\t\t\t\t\t// ä¼˜å…ˆå°è¯•è°ƒç”¨Dify APIè·å–çœŸå®AIå›å¤\r\n\t\t\t\t\tconst aiResponse = await this.callDifyAPI(userMessage)\r\n\t\t\t\t\t\r\n\t\t\t\t\t// æ·»åŠ AIå›å¤åˆ°æ¶ˆæ¯åˆ—è¡¨\r\n\t\t\t\t\tthis.messages.push({\r\n\t\t\t\t\t\trole: 'assistant',\r\n\t\t\t\t\t\tcontent: aiResponse\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t\t// ä¿å­˜AIå›å¤åˆ°æ•°æ®åº“\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tawait conversationService.saveMessage(\r\n\t\t\t\t\t\t\tthis.currentConversationId,\r\n\t\t\t\t\t\t\t'assistant',\r\n\t\t\t\t\t\t\taiResponse\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\tconsole.error('ä¿å­˜AIæ¶ˆæ¯å¤±è´¥:', error)\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// æ˜¾ç¤ºæˆåŠŸæç¤º\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: 'AIå›å¤å·²ç”Ÿæˆ',\r\n\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\tduration: 1500\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error('Dify APIè°ƒç”¨å¤±è´¥:', error)\r\n\t\t\t\t\t\r\n\t\t\t\t\t// æ ¹æ®é”™è¯¯ç±»å‹æ˜¾ç¤ºä¸åŒçš„æç¤ºä¿¡æ¯\r\n\t\t\t\t\tlet errorTitle = 'ç½‘ç»œå¼‚å¸¸'\r\n\t\t\t\t\tlet errorMessage = 'ä½¿ç”¨æœ¬åœ°å›å¤'\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (error.message.includes('è¶…æ—¶')) {\r\n\t\t\t\t\t\terrorTitle = 'è¯·æ±‚è¶…æ—¶'\r\n\t\t\t\t\t\terrorMessage = 'ç½‘ç»œè¿æ¥è¾ƒæ…¢ï¼Œè¯·ç¨åé‡è¯•'\r\n\t\t\t\t\t} else if (error.message.includes('ç½‘ç»œè¿æ¥å¼‚å¸¸')) {\r\n\t\t\t\t\t\terrorTitle = 'ç½‘ç»œè¿æ¥å¼‚å¸¸'\r\n\t\t\t\t\t\terrorMessage = 'è¯·æ£€æŸ¥ç½‘ç»œè®¾ç½®åé‡è¯•'\r\n\t\t\t\t\t} else if (error.message.includes('SSL')) {\r\n\t\t\t\t\t\terrorTitle = 'å®‰å…¨è¿æ¥å¤±è´¥'\r\n\t\t\t\t\t\terrorMessage = 'è¯·æ£€æŸ¥ç½‘ç»œç¯å¢ƒæˆ–åˆ‡æ¢ç½‘ç»œ'\r\n\t\t\t\t\t} else if (error.message.includes('APIè¯·æ±‚æ ¼å¼é”™è¯¯')) {\r\n\t\t\t\t\t\terrorTitle = 'é…ç½®é”™è¯¯'\r\n\t\t\t\t\t\terrorMessage = 'è¯·æ£€æŸ¥APIé…ç½®å‚æ•°'\r\n\t\t\t\t\t} else if (error.message.includes('APIå¯†é’¥æ— æ•ˆ')) {\r\n\t\t\t\t\t\terrorTitle = 'è®¤è¯å¤±è´¥'\r\n\t\t\t\t\t\terrorMessage = 'è¯·æ£€æŸ¥APIå¯†é’¥é…ç½®'\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// APIè°ƒç”¨å¤±è´¥æ—¶ï¼Œä½¿ç”¨æ¨¡æ‹Ÿå›å¤ä½œä¸ºé™çº§æ–¹æ¡ˆ\r\n\t\t\t\t\tconst fallbackResponse = this.generateAIResponse(userMessage)\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.messages.push({\r\n\t\t\t\t\t\trole: 'assistant',\r\n\t\t\t\t\t\tcontent: fallbackResponse\r\n\t\t\t\t\t})\r\n\t\t\t\t\t\r\n\t\t\t\t\t// ä¿å­˜é™çº§å›å¤åˆ°æ•°æ®åº“\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tawait conversationService.saveMessage(\r\n\t\t\t\t\t\t\tthis.currentConversationId,\r\n\t\t\t\t\t\t\t'assistant',\r\n\t\t\t\t\t\t\tfallbackResponse\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\tconsole.error('ä¿å­˜é™çº§æ¶ˆæ¯å¤±è´¥:', error)\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// æ˜¾ç¤ºè¯¦ç»†çš„é”™è¯¯æç¤º\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: `${errorTitle}ï¼Œ${errorMessage}`,\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\tduration: 3000\r\n\t\t\t\t\t})\r\n\t\t\t\t} finally {\r\n\t\t\t\t\t// æ— è®ºæˆåŠŸå¤±è´¥ï¼Œéƒ½éšè—åŠ è½½çŠ¶æ€\r\n\t\t\t\t\tthis.isLoading = false\r\n\t\t\t\t\t\r\n\t\t\t\t\t// æ»šåŠ¨åˆ°æœ€æ–°æ¶ˆæ¯\r\n\t\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\t\tthis.scrollTop = 99999\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// è°ƒç”¨Dify APIè·å–AIå›å¤\r\n\t\t\tcallDifyAPI(userMessage) {\r\n\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\t// æ„å»ºç»“æ„åŒ–è¾“å…¥æ•°æ®ï¼Œä½¿ç”¨Difyå˜é‡ç³»ç»Ÿä¼ é€’è§’è‰²ä¿¡æ¯\r\n\t\t\t\t\tconst inputs = {\r\n\t\t\t\t\t\tquery: userMessage,\r\n\t\t\t\t\t\trole: this.currentRole.name,\r\n\t\t\t\t\t\trole_description: this.currentRole.description,\r\n\t\t\t\t\t\tstyle: this.currentStyle.name,\r\n\t\t\t\t\t\tsystem_prompt: `ä½ æ˜¯ä¸€ä¸ª${this.currentRole.name}ï¼Œè¯·ä»¥${this.currentStyle.name}çš„é£æ ¼å›å¤ç”¨æˆ·ã€‚ä½ çš„è§’è‰²æè¿°æ˜¯ï¼š${this.currentRole.description}`\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// æ·»åŠ è¶…æ—¶æœºåˆ¶\r\n\t\t\t\t\tconst timeout = setTimeout(() => {\r\n\t\t\t\t\t\treject(new Error('è¯·æ±‚è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥'))\r\n\t\t\t\t\t}, 10000) // 10ç§’è¶…æ—¶\r\n\t\t\t\t\t\r\n\t\t\t\t\t// è°ƒè¯•ä¿¡æ¯\r\n\t\t\t\t\tconsole.log('Dify APIé…ç½®:', this.difyConfig)\r\n\t\t\t\t\tconsole.log('å®Œæ•´URL:', this.difyConfig.apiUrl + this.difyConfig.endpoint)\r\n\t\t\t\t\tconsole.log('ç»“æ„åŒ–è¾“å…¥æ•°æ®:', inputs)\r\n\t\t\t\t\t\r\n\t\t\t\t\tuni.request({\r\n\t\t\t\t\t\turl: this.difyConfig.apiUrl + this.difyConfig.endpoint,\r\n\t\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\t\ttimeout: 10000, // 10ç§’è¶…æ—¶\r\n\t\t\t\t\t\theader: {\r\n\t\t\t\t\t\t\t// å°è¯•ä¸åŒçš„è®¤è¯æ–¹å¼\r\n\t\t\t\t\t\t\t'Authorization': 'Bearer ' + this.difyConfig.apiKey,\r\n\t\t\t\t\t\t\t// æˆ–è€…å°è¯•ä½¿ç”¨APIå¯†é’¥ç›´æ¥ä½œä¸ºBearer token\r\n\t\t\t\t\t\t\t// 'Authorization': 'Bearer ' + this.difyConfig.apiKey.replace('app-', ''),\r\n\t\t\t\t\t\t\t'Content-Type': 'application/json'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\t// ä½¿ç”¨Difyå˜é‡ç³»ç»Ÿä¼ é€’ç»“æ„åŒ–æ•°æ®\r\n\t\t\t\t\t\t\tinputs: inputs,\r\n\t\t\t\t\t\t\t// åŒæ—¶æä¾›queryå­—æ®µä¿æŒå‘åå…¼å®¹\r\n\t\t\t\t\t\t\tquery: userMessage,\r\n\t\t\t\t\t\t\tresponse_mode: 'blocking',\r\n\t\t\t\t\t\t\tuser: 'heart-harbor-user'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\tclearTimeout(timeout)\r\n\t\t\t\t\t\t\tconsole.log('Dify APIå“åº”:', res)\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// ç½‘ç»œè¿æ¥æ£€æŸ¥\r\n\t\t\t\t\t\t\tif (res.statusCode === 0) {\r\n\t\t\t\t\t\t\t\treject(new Error('ç½‘ç»œè¿æ¥å¼‚å¸¸ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè®¾ç½®'))\r\n\t\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (res.statusCode === 200 && res.data) {\r\n\t\t\t\t\t\t\t\t// æå–AIå›å¤å†…å®¹ï¼Œé€‚é…ä¸åŒçš„å“åº”æ ¼å¼\r\n\t\t\t\t\t\t\t\tlet aiResponse = 'æˆ‘æ”¶åˆ°äº†ä½ çš„æ¶ˆæ¯ï¼Œæ­£åœ¨æ€è€ƒå¦‚ä½•å›å¤...'\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tif (res.data.answer) {\r\n\t\t\t\t\t\t\t\t\taiResponse = res.data.answer\r\n\t\t\t\t\t\t\t\t} else if (res.data.message) {\r\n\t\t\t\t\t\t\t\t\taiResponse = res.data.message\r\n\t\t\t\t\t\t\t\t} else if (res.data.data && res.data.data.answer) {\r\n\t\t\t\t\t\t\t\t\taiResponse = res.data.data.answer\r\n\t\t\t\t\t\t\t\t} else if (typeof res.data === 'string') {\r\n\t\t\t\t\t\t\t\t\taiResponse = res.data\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t// ç¡®ä¿å›å¤å†…å®¹ä¸ä¸ºç©º\r\n\t\t\t\t\t\t\t\tif (!aiResponse || aiResponse.trim() === '') {\r\n\t\t\t\t\t\t\t\t\taiResponse = 'æˆ‘ç†è§£ä½ çš„æ„Ÿå—ï¼Œä½†éœ€è¦æ›´å¤šä¿¡æ¯æ¥æä¾›æ›´å¥½çš„å¸®åŠ©ã€‚å¯ä»¥è¯¦ç»†è¯´è¯´å—ï¼Ÿ'\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tresolve(aiResponse)\r\n\t\t\t\t\t\t\t} else if (res.statusCode === 400) {\r\n\t\t\t\t\t\t\t\t// æ›´è¯¦ç»†çš„400é”™è¯¯å¤„ç†\r\n\t\t\t\t\t\t\t\tlet errorDetail = 'APIè¯·æ±‚æ ¼å¼é”™è¯¯'\r\n\t\t\t\t\t\t\t\tif (res.data && res.data.message) {\r\n\t\t\t\t\t\t\t\t\terrorDetail += `: ${res.data.message}`\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treject(new Error(errorDetail))\r\n\t\t\t\t\t\t\t} else if (res.statusCode === 401) {\r\n\t\t\t\t\t\t\t\treject(new Error('APIå¯†é’¥æ— æ•ˆï¼Œè¯·æ£€æŸ¥é…ç½®'))\r\n\t\t\t\t\t\t\t} else if (res.statusCode === 403) {\r\n\t\t\t\t\t\t\t\treject(new Error('APIè®¿é—®è¢«æ‹’ç»ï¼Œè¯·æ£€æŸ¥æƒé™'))\r\n\t\t\t\t\t\t\t} else if (res.statusCode === 404) {\r\n\t\t\t\t\t\t\t\treject(new Error('APIæ¥å£ä¸å­˜åœ¨ï¼Œè¯·æ£€æŸ¥URLé…ç½®'))\r\n\t\t\t\t\t\t\t} else if (res.statusCode >= 500) {\r\n\t\t\t\t\t\t\t\treject(new Error('æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•'))\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\treject(new Error(`APIè¿”å›å¼‚å¸¸çŠ¶æ€ç : ${res.statusCode}`))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\t\tclearTimeout(timeout)\r\n\t\t\t\t\t\t\tconsole.error('Dify APIè°ƒç”¨å¤±è´¥:', err)\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// æ›´è¯¦ç»†çš„é”™è¯¯åˆ†ç±»\r\n\t\t\t\t\t\t\tlet errorMessage = 'ç½‘ç»œè¯·æ±‚å¤±è´¥'\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (err.errMsg) {\r\n\t\t\t\t\t\t\t\tif (err.errMsg.includes('timeout')) {\r\n\t\t\t\t\t\t\t\t\terrorMessage = 'è¯·æ±‚è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥'\r\n\t\t\t\t\t\t\t\t} else if (err.errMsg.includes('network')) {\r\n\t\t\t\t\t\t\t\t\terrorMessage = 'ç½‘ç»œè¿æ¥å¼‚å¸¸ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè®¾ç½®'\r\n\t\t\t\t\t\t\t\t} else if (err.errMsg.includes('abort')) {\r\n\t\t\t\t\t\t\t\t\terrorMessage = 'è¯·æ±‚è¢«å–æ¶ˆ'\r\n\t\t\t\t\t\t\t\t} else if (err.errMsg.includes('SSL')) {\r\n\t\t\t\t\t\t\t\t\terrorMessage = 'SSLè¯ä¹¦éªŒè¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œç¯å¢ƒ'\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\treject(new Error(errorMessage))\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\t// æ ¹æ®è§’è‰²å’Œé£æ ¼ç”ŸæˆAIå›å¤\r\n\t\t\tgenerateAIResponse(userMessage) {\r\n\t\t\t\t// åŸºç¡€å›å¤æ¨¡æ¿\r\n\t\t\t\tconst baseResponses = {\r\n\t\t\t\t\tcompanion: {\r\n\t\t\t\t\t\tfriendly: {\r\n\t\t\t\t\t\t\tpressure: 'äº²çˆ±çš„ï¼Œæ„Ÿå—åˆ°ä½ æœ‰äº›å‹åŠ›å‘¢ï½è¿™å¾ˆæ­£å¸¸å“¦ï¼å¯ä»¥è¯•è¯•æ·±å‘¼å¸æ”¾æ¾ä¸€ä¸‹ï¼Œæˆ–è€…å’Œæˆ‘èŠèŠå…·ä½“æ˜¯ä»€ä¹ˆè®©ä½ æ„Ÿåˆ°å‹åŠ›ï¼ŸğŸ˜Š',\r\n\t\t\t\t\t\t\thappy: 'çœŸä¸ºä½ æ„Ÿåˆ°é«˜å…´ï¼ä¿æŒç§¯æçš„å¿ƒæ€å¾ˆé‡è¦å‘¢ï½æ„¿æ„å’Œæˆ‘åˆ†äº«æ›´å¤šè®©ä½ å¼€å¿ƒçš„äº‹æƒ…å—ï¼ŸğŸ’–',\r\n\t\t\t\t\t\t\tsad: 'å¬åˆ°ä½ éš¾è¿‡æˆ‘ä¹Ÿæ„Ÿåˆ°å¿ƒç–¼å‘¢ã€‚æƒ…ç»ªæ³¢åŠ¨æ˜¯æ­£å¸¸çš„ï¼Œé‡è¦çš„æ˜¯ç»™è‡ªå·±æ—¶é—´å’Œç©ºé—´å»æ„Ÿå—å’Œå¤„ç†è¿™äº›æƒ…ç»ªã€‚æŠ±æŠ±ä½ ï½'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tprofessional: {\r\n\t\t\t\t\t\t\tpressure: 'æˆ‘æ³¨æ„åˆ°æ‚¨æåˆ°äº†ä¸€äº›å‹åŠ›æ„Ÿå—ã€‚å‹åŠ›æ˜¯å¸¸è§çš„å¿ƒç†ååº”ï¼Œå»ºè®®æ‚¨å¯ä»¥å°è¯•ä¸€äº›æ”¾æ¾æŠ€å·§ï¼Œæ¯”å¦‚æ·±å‘¼å¸æˆ–æ¸è¿›å¼è‚Œè‚‰æ”¾æ¾ã€‚',\r\n\t\t\t\t\t\t\thappy: 'ä¸ºæ‚¨æ„Ÿåˆ°é«˜å…´ã€‚ç§¯ææƒ…ç»ªå¯¹å¿ƒç†å¥åº·æœ‰é‡è¦å½±å“ï¼Œå»ºè®®ç»§ç»­ä¿æŒè¿™ç§ç§¯æçŠ¶æ€ã€‚',\r\n\t\t\t\t\t\t\tsad: 'ç†è§£æ‚¨çš„æƒ…ç»ªæ„Ÿå—ã€‚æƒ…ç»ªæ³¢åŠ¨æ˜¯æ­£å¸¸çš„å¿ƒç†ç°è±¡ï¼Œå»ºè®®ç»™è‡ªå·±é€‚å½“çš„æƒ…ç»ªè°ƒèŠ‚ç©ºé—´ã€‚'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tencouraging: {\r\n\t\t\t\t\t\t\tpressure: 'æ„Ÿå—åˆ°ä½ çš„å‹åŠ›ï¼Œä½†è¯·ç›¸ä¿¡ä½ æœ‰èƒ½åŠ›åº”å¯¹ï¼æ¯ä¸€æ¬¡æŒ‘æˆ˜éƒ½æ˜¯æˆé•¿çš„æœºä¼šï¼ŒåŠ æ²¹ï¼ğŸŒŸ',\r\n\t\t\t\t\t\t\thappy: 'çœŸæ£’ï¼ç»§ç»­ä¿æŒè¿™ç§ç§¯æçš„çŠ¶æ€ï¼Œä½ çš„å¿«ä¹ä¹Ÿä¼šæ„ŸæŸ“èº«è¾¹çš„äººï¼',\r\n\t\t\t\t\t\t\tsad: 'éš¾è¿‡çš„æ—¶å€™è¯·è®°å¾—ï¼Œä½ å¹¶ä¸å­¤å•ã€‚æ¯ä¸€æ¬¡æƒ…ç»ªæ³¢åŠ¨éƒ½æ˜¯è‡ªæˆ‘äº†è§£çš„æœºä¼šï¼Œç›¸ä¿¡ä½ ä¼šå˜å¾—æ›´å¼ºå¤§ï¼'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcasual: {\r\n\t\t\t\t\t\t\tpressure: 'å“ˆå“ˆï¼Œå‹åŠ›å±±å¤§å•Šï¼Ÿæ”¾æ¾ç‚¹ï¼Œç”Ÿæ´»å°±æ˜¯è¿™æ ·ï¼Œæœ‰èµ·æœ‰è½ï½èŠèŠçœ‹å…·ä½“å•¥æƒ…å†µï¼ŸğŸ˜„',\r\n\t\t\t\t\t\t\thappy: 'å“‡ï¼Œå¬èµ·æ¥ä¸é”™å˜›ï¼å¼€å¿ƒçš„äº‹æƒ…è¦å¤šå¤šåˆ†äº«ï¼Œè®©å¿«ä¹åŠ å€ï¼',\r\n\t\t\t\t\t\t\tsad: 'å“ï¼Œæœ‰æ—¶å€™ç¡®å®ä¼šæœ‰ç‚¹downå‘¢ã€‚ä¸è¿‡æ²¡å…³ç³»ï¼Œè¯´å‡ºæ¥å°±å¥½å¤šäº†ï¼Œæˆ‘åœ¨è¿™å„¿å¬ç€å‘¢ï½'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tadvisor: {\r\n\t\t\t\t\t\tfriendly: {\r\n\t\t\t\t\t\t\tpressure: 'æ‚¨å¥½ï¼ä»æ‚¨çš„æè¿°ä¸­æˆ‘æ„Ÿå—åˆ°ä¸€äº›å‹åŠ›ã€‚ä½œä¸ºä¸“ä¸šé¡¾é—®ï¼Œæˆ‘å»ºè®®æ‚¨å¯ä»¥å°è¯•è®¤çŸ¥è¡Œä¸ºç–—æ³•ä¸­çš„ä¸€äº›æŠ€å·§æ¥ç®¡ç†å‹åŠ›ã€‚',\r\n\t\t\t\t\t\t\thappy: 'å¾ˆé«˜å…´å¬åˆ°æ‚¨çš„ç§¯æä½“éªŒï¼ç§¯ææƒ…ç»ªå¯¹å¿ƒç†å¥åº·æœ‰é‡è¦ä¿ƒè¿›ä½œç”¨ã€‚',\r\n\t\t\t\t\t\t\tsad: 'ç†è§£æ‚¨çš„æƒ…ç»ªå›°æ‰°ã€‚ä»ä¸“ä¸šè§’åº¦ï¼Œå»ºè®®æ‚¨å…³æ³¨æƒ…ç»ªè°ƒèŠ‚ç­–ç•¥çš„åº”ç”¨ã€‚'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tprofessional: {\r\n\t\t\t\t\t\t\tpressure: 'æ ¹æ®æ‚¨çš„æè¿°ï¼Œå»ºè®®é‡‡ç”¨å‹åŠ›ç®¡ç†ä¸‰æ­¥éª¤ï¼šè¯†åˆ«å‹åŠ›æºã€è¯„ä¼°å‹åŠ›æ°´å¹³ã€å®æ–½åº”å¯¹ç­–ç•¥ã€‚',\r\n\t\t\t\t\t\t\thappy: 'ç§¯ææƒ…ç»ªä½“éªŒå¯¹å¿ƒç†å¥åº·å…·æœ‰æ­£å‘å½±å“ï¼Œå»ºè®®ç»§ç»­ä¿æŒå¹¶è®°å½•ç§¯æäº‹ä»¶ã€‚',\r\n\t\t\t\t\t\t\tsad: 'æƒ…ç»ªå›°æ‰°éœ€è¦ç³»ç»Ÿè¯„ä¼°ï¼Œå»ºè®®é‡‡ç”¨æƒ…ç»ªæ—¥è®°è¿›è¡Œè¿½è¸ªè®°å½•ã€‚'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tencouraging: {\r\n\t\t\t\t\t\t\tpressure: 'æ‚¨å±•ç°å‡ºäº†å¾ˆå¥½çš„è‡ªæˆ‘è§‰å¯Ÿèƒ½åŠ›ï¼å‹åŠ›ç®¡ç†æ˜¯ä¸€ä¸ªå­¦ä¹ è¿‡ç¨‹ï¼Œç›¸ä¿¡æ‚¨èƒ½é€æ­¥æŒæ¡æœ‰æ•ˆç­–ç•¥ã€‚',\r\n\t\t\t\t\t\t\thappy: 'æ‚¨çš„ç§¯æä½“éªŒå±•ç¤ºäº†è‰¯å¥½çš„å¿ƒç†é€‚åº”èƒ½åŠ›ï¼Œè¿™æ˜¯å¿ƒç†å¥åº·çš„é‡è¦æ ‡å¿—ã€‚',\r\n\t\t\t\t\t\t\tsad: 'é¢å¯¹æƒ…ç»ªå›°æ‰°éœ€è¦å‹‡æ°”ï¼Œæ‚¨å·²ç»è¿ˆå‡ºäº†é‡è¦ä¸€æ­¥ã€‚æŒç»­å…³æ³¨æƒ…ç»ªå¥åº·ä¼šæœ‰ç§¯æå›æŠ¥ã€‚'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcasual: {\r\n\t\t\t\t\t\t\tpressure: 'å‹åŠ›è¿™äº‹å„¿ï¼Œè¯´å¤§ä¸å¤§è¯´å°ä¸å°ï½å…³é”®æ˜¯æ‰¾åˆ°é€‚åˆè‡ªå·±çš„è°ƒèŠ‚æ–¹å¼ï¼Œå’±ä»¬ä¸€èµ·åˆ†æåˆ†æï¼Ÿ',\r\n\t\t\t\t\t\t\thappy: 'ä¸é”™å˜›ï¼ç§¯ææƒ…ç»ªå°±åƒå¿ƒç†ç»´ç”Ÿç´ ï¼Œå¤šå¤šç›Šå–„ï½',\r\n\t\t\t\t\t\t\tsad: 'æƒ…ç»ªæœ‰èµ·ä¼å¾ˆæ­£å¸¸ï¼Œé‡è¦çš„æ˜¯å­¦ä¼šå’Œå®ƒä»¬å’Œå¹³ç›¸å¤„ã€‚æœ‰å•¥å…·ä½“æƒ³èŠçš„ï¼Ÿ'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// æ ¹æ®å…³é”®è¯åŒ¹é…å›å¤ç±»å‹\r\n\t\t\t\tlet responseType = 'default'\r\n\t\t\t\tif (userMessage.includes('å‹åŠ›') || userMessage.includes('ç„¦è™‘') || userMessage.includes('ç´§å¼ ')) {\r\n\t\t\t\t\tresponseType = 'pressure'\r\n\t\t\t\t} else if (userMessage.includes('å¼€å¿ƒ') || userMessage.includes('é«˜å…´') || userMessage.includes('æ„‰å¿«')) {\r\n\t\t\t\t\tresponseType = 'happy'\r\n\t\t\t\t} else if (userMessage.includes('éš¾è¿‡') || userMessage.includes('ä¼¤å¿ƒ') || userMessage.includes('æ²®ä¸§')) {\r\n\t\t\t\t\tresponseType = 'sad'\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// è·å–å¯¹åº”çš„å›å¤\r\n\t\t\t\tconst roleResponses = baseResponses[this.currentRole.id]\r\n\t\t\t\tconst styleResponses = roleResponses[this.currentStyle.id]\r\n\t\t\t\t\r\n\t\t\t\tif (styleResponses && styleResponses[responseType]) {\r\n\t\t\t\t\treturn styleResponses[responseType]\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// é»˜è®¤å›å¤\r\n\t\t\t\tconst defaultResponses = {\r\n\t\t\t\t\tcompanion: {\r\n\t\t\t\t\t\tfriendly: 'è°¢è°¢ä½ çš„åˆ†äº«ï¼æˆ‘åœ¨è¿™é‡Œå€¾å¬ï¼Œå¦‚æœä½ æ„¿æ„ï¼Œå¯ä»¥å‘Šè¯‰æˆ‘æ›´å¤šå…³äºä½ çš„æ„Ÿå—å’Œæƒ³æ³•ã€‚ğŸ˜Š',\r\n\t\t\t\t\t\tprofessional: 'æ„Ÿè°¢æ‚¨çš„åˆ†äº«ã€‚æˆ‘å°†åŸºäºä¸“ä¸šè§’åº¦ä¸ºæ‚¨æä¾›åˆ†æå»ºè®®ã€‚',\r\n\t\t\t\t\t\tencouraging: 'æ„Ÿè°¢åˆ†äº«ï¼æ¯ä¸€æ¬¡äº¤æµéƒ½æ˜¯æˆé•¿çš„æœºä¼šï¼Œç»§ç»­åŠ æ²¹ï¼ğŸŒŸ',\r\n\t\t\t\t\t\tcasual: 'å“ˆå“ˆï¼ŒèŠå¾—ä¸é”™å˜›ï¼è¿˜æœ‰ä»€ä¹ˆæƒ³è¯´çš„å°½ç®¡æ¥ï½ğŸ˜„'\r\n\t\t\t\t\t},\r\n\t\t\t\t\tadvisor: {\r\n\t\t\t\t\t\tfriendly: 'æ„Ÿè°¢æ‚¨çš„ä¿¡ä»»ã€‚ä½œä¸ºä¸“ä¸šé¡¾é—®ï¼Œæˆ‘å°†ä¸ºæ‚¨æä¾›ç†æ€§çš„åˆ†æå’Œå»ºè®®ã€‚',\r\n\t\t\t\t\t\tprofessional: 'æ”¶åˆ°æ‚¨çš„ä¿¡æ¯ã€‚å»ºè®®è¿›ä¸€æ­¥è¯¦ç»†æè¿°å…·ä½“æƒ…å†µä»¥ä¾¿ç²¾å‡†åˆ†æã€‚',\r\n\t\t\t\t\t\tencouraging: 'æ„Ÿè°¢åˆ†äº«ï¼ä¸“ä¸šå’¨è¯¢éœ€è¦è¯¦ç»†æ²Ÿé€šï¼Œç›¸ä¿¡æˆ‘ä»¬èƒ½æ‰¾åˆ°æœ‰æ•ˆè§£å†³æ–¹æ¡ˆã€‚',\r\n\t\t\t\t\t\tcasual: 'å¥½çš„ï¼Œä¿¡æ¯æ”¶åˆ°ã€‚å’±ä»¬ç»§ç»­æ·±å…¥èŠèŠå…·ä½“æƒ…å†µï¼Ÿ'\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn defaultResponses[this.currentRole.id][this.currentStyle.id]\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style scoped>\r\n.ai-page {\r\n\tmin-height: 100vh;\r\n\tbackground: linear-gradient(135deg, #E6F3FF 0%, #F5F9FF 100%);\r\n\tpadding: 20rpx;\r\n}\r\n\r\n/* é¡¶éƒ¨åŠŸèƒ½åŒºæ ·å¼ - ä¼˜åŒ–å */\r\n.top-bar {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: space-between;\r\n\tmargin-bottom: 30rpx;\r\n\tpadding: 25rpx 0;\r\n\tgap: 20rpx;\r\n}\r\n\r\n/* è™šæ‹ŸäººæŒ‰é’® - ä¼˜åŒ–å */\r\n.virtual-human-btn {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\talign-items: center;\r\n\tpadding: 18rpx 30rpx;\r\n\tbackground: rgba(255, 255, 255, 0.95);\r\n\tborder-radius: 25rpx;\r\n\tborder: 2rpx solid #E6F3FF;\r\n\tbox-shadow: 0 6rpx 20rpx rgba(24, 144, 255, 0.15);\r\n\ttransition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n\tmin-height: 80rpx;\r\n\tjustify-content: center;\r\n}\r\n\r\n.virtual-human-btn:active {\r\n\tbackground: #E6F3FF;\r\n\ttransform: scale(0.95);\r\n\tbox-shadow: 0 4rpx 12rpx rgba(24, 144, 255, 0.2);\r\n}\r\n\r\n.virtual-icon {\r\n\tfont-size: 40rpx;\r\n\tmargin-bottom: 8rpx;\r\n}\r\n\r\n.virtual-text {\r\n\tfont-size: 26rpx;\r\n\tcolor: #1890FF;\r\n\tfont-weight: 600;\r\n}\r\n\r\n/* å½“å‰è®¾ç½®æ˜¾ç¤º - ä¼˜åŒ–å */\r\n.current-settings {\r\n\tbackground: rgba(255, 255, 255, 0.95);\r\n\tpadding: 18rpx 30rpx;\r\n\tborder-radius: 25rpx;\r\n\tborder: 2rpx solid #E6F3FF;\r\n\tbox-shadow: 0 6rpx 20rpx rgba(24, 144, 255, 0.15);\r\n\tmin-height: 80rpx;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tflex: 1;\r\n\tmargin: 0 20rpx;\r\n}\r\n\r\n.settings-text {\r\n\tfont-size: 28rpx;\r\n\tcolor: #333;\r\n\tfont-weight: 600;\r\n\ttext-align: center;\r\n}\r\n\r\n/* å¯¹è¯æ“ä½œæŒ‰é’®ç»„ - ä¼˜åŒ–å */\r\n.conversation-actions {\r\n\tdisplay: flex;\r\n\tgap: 15rpx;\r\n\talign-items: center;\r\n}\r\n\r\n.new-conversation-btn, .history-btn {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\talign-items: center;\r\n\tpadding: 18rpx 25rpx;\r\n\tbackground: rgba(255, 255, 255, 0.95);\r\n\tborder-radius: 20rpx;\r\n\tborder: 2rpx solid #E6F3FF;\r\n\ttransition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n\tmin-height: 80rpx;\r\n\tjustify-content: center;\r\n\tbox-shadow: 0 6rpx 20rpx rgba(24, 144, 255, 0.15);\r\n}\r\n\r\n.new-conversation-btn:active, .history-btn:active {\r\n\tbackground: #E6F3FF;\r\n\ttransform: scale(0.95);\r\n\tbox-shadow: 0 4rpx 12rpx rgba(24, 144, 255, 0.2);\r\n}\r\n\r\n.action-icon {\r\n\tfont-size: 36rpx;\r\n\tmargin-bottom: 8rpx;\r\n}\r\n\r\n.action-text {\r\n\tfont-size: 24rpx;\r\n\tcolor: #1890FF;\r\n\tfont-weight: 600;\r\n}\r\n\r\n.virtual-human-btn {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\talign-items: center;\r\n\tpadding: 15rpx 25rpx;\r\n\tbackground: rgba(255, 255, 255, 0.8);\r\n\tborder-radius: 20rpx;\r\n\tborder: 2rpx solid #E6F3FF;\r\n\tbox-shadow: 0 4rpx 15rpx rgba(24, 144, 255, 0.1);\r\n}\r\n\r\n.virtual-icon {\r\n\tfont-size: 36rpx;\r\n\tmargin-bottom: 5rpx;\r\n}\r\n\r\n.virtual-text {\r\n\tfont-size: 24rpx;\r\n\tcolor: #1890FF;\r\n\tfont-weight: bold;\r\n}\r\n\r\n.coming-soon {\r\n\tfont-size: 20rpx;\r\n\tcolor: #999;\r\n\tmargin-top: 5rpx;\r\n}\r\n\r\n.current-settings {\r\n\tbackground: rgba(255, 255, 255, 0.9);\r\n\tpadding: 15rpx 25rpx;\r\n\tborder-radius: 20rpx;\r\n\tborder: 2rpx solid #E6F3FF;\r\n}\r\n\r\n.settings-text {\r\n\tfont-size: 26rpx;\r\n\tcolor: #666;\r\n\tfont-weight: 500;\r\n}\r\n\r\n.conversation-actions {\r\n\tdisplay: flex;\r\n\tgap: 15rpx;\r\n}\r\n\r\n.new-conversation-btn, .history-btn {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\talign-items: center;\r\n\tpadding: 15rpx 20rpx;\r\n\tbackground: rgba(255, 255, 255, 0.9);\r\n\tborder-radius: 15rpx;\r\n\tborder: 2rpx solid #E6F3FF;\r\n\ttransition: all 0.3s ease;\r\n}\r\n\r\n.new-conversation-btn:active, .history-btn:active {\r\n\tbackground: #E6F3FF;\r\n\ttransform: scale(0.95);\r\n}\r\n\r\n.action-icon {\r\n\tfont-size: 32rpx;\r\n\tmargin-bottom: 5rpx;\r\n}\r\n\r\n.action-text {\r\n\tfont-size: 22rpx;\r\n\tcolor: #1890FF;\r\n\tfont-weight: 500;\r\n}\r\n\r\n/* åŠŸèƒ½åŒºæ ‡é¢˜ - ä¼˜åŒ–å */\r\n.section-title {\r\n\tdisplay: block;\r\n\tfont-size: 34rpx;\r\n\tfont-weight: 700;\r\n\tcolor: #1890FF;\r\n\tmargin-bottom: 25rpx;\r\n\ttext-align: center;\r\n\tposition: relative;\r\n}\r\n\r\n.section-title::after {\r\n\tcontent: '';\r\n\tdisplay: block;\r\n\twidth: 60rpx;\r\n\theight: 4rpx;\r\n\tbackground: linear-gradient(90deg, #1890FF, #40A9FF);\r\n\tborder-radius: 2rpx;\r\n\tmargin: 10rpx auto 0;\r\n}\r\n\r\n/* è§’è‰²é€‰æ‹©åŒºæ ·å¼ - ä¼˜åŒ–å */\r\n.role-section {\r\n\tmargin-bottom: 35rpx;\r\n\tbackground: rgba(255, 255, 255, 0.95);\r\n\tborder-radius: 25rpx;\r\n\tpadding: 30rpx;\r\n\tborder: 2rpx solid #E6F3FF;\r\n\tbox-shadow: 0 8rpx 30rpx rgba(24, 144, 255, 0.1);\r\n}\r\n\r\n.role-list {\r\n\tdisplay: flex;\r\n\twhite-space: nowrap;\r\n\tgap: 20rpx;\r\n\tpadding: 10rpx 0;\r\n\talign-items: center;\r\n\tjustify-content: flex-start;\r\n}\r\n\r\n.role-item {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tpadding: 30rpx 40rpx;\r\n\tbackground: #F8F9FA;\r\n\tborder-radius: 25rpx;\r\n\tborder: 2rpx solid transparent;\r\n\ttransition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n\tmin-width: 200rpx;\r\n\tcursor: pointer;\r\n\tposition: relative;\r\n\toverflow: hidden;\r\n\ttext-align: center;\r\n}\r\n\r\n.role-item::before {\r\n\tcontent: '';\r\n\tposition: absolute;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\tright: 0;\r\n\theight: 4rpx;\r\n\tbackground: linear-gradient(90deg, #1890FF, #40A9FF);\r\n\ttransform: scaleX(0);\r\n\ttransition: transform 0.3s ease;\r\n}\r\n\r\n.role-item.active {\r\n\tbackground: linear-gradient(135deg, #E6F3FF 0%, #D6EBFF 100%);\r\n\tborder-color: #1890FF;\r\n\ttransform: translateY(-8rpx);\r\n\tbox-shadow: 0 12rpx 35rpx rgba(24, 144, 255, 0.25);\r\n}\r\n\r\n.role-item.active::before {\r\n\ttransform: scaleX(1);\r\n}\r\n\r\n.role-item:active {\r\n\ttransform: scale(0.98);\r\n}\r\n\r\n.role-icon {\r\n\tfont-size: 56rpx;\r\n\tmargin-bottom: 20rpx;\r\n\ttransition: transform 0.3s ease;\r\n}\r\n\r\n.role-item.active .role-icon {\r\n\ttransform: scale(1.1);\r\n}\r\n\r\n.role-name {\r\n\tfont-size: 30rpx;\r\n\tfont-weight: 700;\r\n\tcolor: #333;\r\n\tmargin-bottom: 12rpx;\r\n}\r\n\r\n.role-desc {\r\n\tfont-size: 24rpx;\r\n\tcolor: #666;\r\n\ttext-align: center;\r\n\tline-height: 1.4;\r\n}\r\n\r\n/* é£æ ¼è®¾ç½®åŒºæ ·å¼ - ä¼˜åŒ–å */\r\n.style-section {\r\n\tmargin-bottom: 35rpx;\r\n\tbackground: rgba(255, 255, 255, 0.95);\r\n\tborder-radius: 25rpx;\r\n\tpadding: 30rpx;\r\n\tborder: 2rpx solid #E6F3FF;\r\n\tbox-shadow: 0 8rpx 30rpx rgba(24, 144, 255, 0.1);\r\n}\r\n\r\n.style-tags {\r\n\tdisplay: flex;\r\n\tflex-wrap: wrap;\r\n\tgap: 20rpx;\r\n\tjustify-content: center;\r\n}\r\n\r\n.style-tag {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tpadding: 25rpx 30rpx;\r\n\tbackground: #F8F9FA;\r\n\tborder-radius: 20rpx;\r\n\tborder: 2rpx solid transparent;\r\n\ttransition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n\tmin-width: 180rpx;\r\n\tjustify-content: center;\r\n\tcursor: pointer;\r\n\tposition: relative;\r\n\toverflow: hidden;\r\n}\r\n\r\n.style-tag::before {\r\n\tcontent: '';\r\n\tposition: absolute;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\tright: 0;\r\n\theight: 3rpx;\r\n\tbackground: linear-gradient(90deg, #1890FF, #40A9FF);\r\n\ttransform: scaleX(0);\r\n\ttransition: transform 0.3s ease;\r\n}\r\n\r\n.style-tag.active {\r\n\tbackground: linear-gradient(135deg, #E6F3FF 0%, #D6EBFF 100%);\r\n\tborder-color: #1890FF;\r\n\ttransform: translateY(-5rpx);\r\n\tbox-shadow: 0 10rpx 30rpx rgba(24, 144, 255, 0.2);\r\n}\r\n\r\n.style-tag.active::before {\r\n\ttransform: scaleX(1);\r\n}\r\n\r\n.style-tag:active {\r\n\ttransform: scale(0.98);\r\n}\r\n\r\n.style-icon {\r\n\tfont-size: 36rpx;\r\n\tmargin-right: 15rpx;\r\n\ttransition: transform 0.3s ease;\r\n}\r\n\r\n.style-tag.active .style-icon {\r\n\ttransform: scale(1.1);\r\n}\r\n\r\n.style-name {\r\n\tfont-size: 28rpx;\r\n\tcolor: #333;\r\n\tfont-weight: 600;\r\n}\r\n\r\n/* èŠå¤©å®¹å™¨æ ·å¼ - ä¼˜åŒ–å */\r\n.chat-container {\r\n\tbackground: #fff;\r\n\tborder-radius: 25rpx;\r\n\tpadding: 35rpx;\r\n\theight: calc(100vh - 650rpx);\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tbox-shadow: 0 8rpx 35rpx rgba(24, 144, 255, 0.15);\r\n\tborder: 2rpx solid #E6F3FF;\r\n}\r\n\r\n.message-list {\r\n\tflex: 1;\r\n\tmargin-bottom: 35rpx;\r\n\tpadding: 10rpx 0;\r\n}\r\n\r\n.message-item {\r\n\tdisplay: flex;\r\n\tmargin-bottom: 35rpx;\r\n\talign-items: flex-start;\r\n\tanimation: messageSlideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);\r\n}\r\n\r\n@keyframes messageSlideIn {\r\n\tfrom {\r\n\t\topacity: 0;\r\n\t\ttransform: translateY(20rpx);\r\n\t}\r\n\tto {\r\n\t\topacity: 1;\r\n\t\ttransform: translateY(0);\r\n\t}\r\n}\r\n\r\n.user-message {\r\n\tflex-direction: row-reverse;\r\n}\r\n\r\n.ai-message {\r\n\tflex-direction: row;\r\n}\r\n\r\n.avatar {\r\n\twidth: 90rpx;\r\n\theight: 90rpx;\r\n\tborder-radius: 50%;\r\n\tbackground: #E6F3FF;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tfont-size: 40rpx;\r\n\tmargin: 0 25rpx;\r\n\tbox-shadow: 0 4rpx 15rpx rgba(24, 144, 255, 0.2);\r\n\ttransition: transform 0.3s ease;\r\n}\r\n\r\n.message-item:hover .avatar {\r\n\ttransform: scale(1.05);\r\n}\r\n\r\n.content {\r\n\tmax-width: 75%;\r\n\tbackground: #F8F9FA;\r\n\tborder-radius: 25rpx;\r\n\tpadding: 25rpx;\r\n\tfont-size: 30rpx;\r\n\tline-height: 1.6;\r\n\tposition: relative;\r\n\tbox-shadow: 0 4rpx 15rpx rgba(0, 0, 0, 0.08);\r\n\ttransition: all 0.3s ease;\r\n}\r\n\r\n.content::before {\r\n\tcontent: '';\r\n\tposition: absolute;\r\n\ttop: 20rpx;\r\n\twidth: 0;\r\n\theight: 0;\r\n\tborder: 10rpx solid transparent;\r\n}\r\n\r\n.ai-message .content::before {\r\n\tleft: -20rpx;\r\n\tborder-right-color: #F8F9FA;\r\n}\r\n\r\n.user-message .content::before {\r\n\tright: -20rpx;\r\n\tborder-left-color: #1890FF;\r\n}\r\n\r\n.user-message .content {\r\n\tbackground: linear-gradient(135deg, #1890FF 0%, #40A9FF 100%);\r\n\tcolor: white;\r\n\tbox-shadow: 0 6rpx 20rpx rgba(24, 144, 255, 0.25);\r\n}\r\n\r\n/* è¾“å…¥åŒºåŸŸæ ·å¼ - ä¼˜åŒ–å */\r\n.input-area {\r\n\tdisplay: flex;\r\n\tgap: 25rpx;\r\n\talign-items: center;\r\n\tbackground: rgba(255, 255, 255, 0.95);\r\n\tborder-radius: 30rpx;\r\n\tpadding: 20rpx 25rpx;\r\n\tborder: 2rpx solid #E6F3FF;\r\n\tbox-shadow: 0 6rpx 20rpx rgba(24, 144, 255, 0.1);\r\n}\r\n\r\n.input {\r\n\tflex: 1;\r\n\theight: 90rpx;\r\n\tbackground: #F8F9FA;\r\n\tborder: 2rpx solid #E6F3FF;\r\n\tborder-radius: 45rpx;\r\n\tpadding: 0 35rpx;\r\n\tfont-size: 30rpx;\r\n\ttransition: all 0.3s ease;\r\n}\r\n\r\n.input:focus {\r\n\tborder-color: #1890FF;\r\n\tbox-shadow: 0 0 0 4rpx rgba(24, 144, 255, 0.1);\r\n}\r\n\r\n.send-btn {\r\n\twidth: 140rpx;\r\n\theight: 90rpx;\r\n\tbackground: linear-gradient(135deg, #1890FF 0%, #40A9FF 100%);\r\n\tcolor: white;\r\n\tborder-radius: 45rpx;\r\n\tfont-size: 30rpx;\r\n\tfont-weight: 600;\r\n\tborder: none;\r\n\ttransition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n\tbox-shadow: 0 6rpx 20rpx rgba(24, 144, 255, 0.3);\r\n}\r\n\r\n.send-btn:active {\r\n\ttransform: scale(0.95);\r\n\tbox-shadow: 0 4rpx 12rpx rgba(24, 144, 255, 0.4);\r\n}\r\n\r\n/* æ¨¡æ€æ¡†æ ·å¼ - ä¼˜åŒ–å */\r\n.modal {\r\n\tposition: fixed;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\tright: 0;\r\n\tbottom: 0;\r\n\tbackground: rgba(0, 0, 0, 0.6);\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tz-index: 9999;\r\n\tanimation: modalFadeIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n}\r\n\r\n@keyframes modalFadeIn {\r\n\tfrom {\r\n\t\topacity: 0;\r\n\t\tbackdrop-filter: blur(0px);\r\n\t}\r\n\tto {\r\n\t\topacity: 1;\r\n\t\tbackdrop-filter: blur(10px);\r\n\t}\r\n}\r\n\r\n.modal-content {\r\n\tbackground: white;\r\n\tborder-radius: 35rpx;\r\n\tpadding: 45rpx;\r\n\tmargin: 40rpx;\r\n\tmax-width: 650rpx;\r\n\tbox-shadow: 0 15rpx 60rpx rgba(0, 0, 0, 0.4);\r\n\tanimation: modalSlideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);\r\n\tborder: 2rpx solid #E6F3FF;\r\n}\r\n\r\n@keyframes modalSlideIn {\r\n\tfrom {\r\n\t\ttransform: scale(0.8) translateY(50rpx);\r\n\t\topacity: 0;\r\n\t}\r\n\tto {\r\n\t\ttransform: scale(1) translateY(0);\r\n\t\topacity: 1;\r\n\t}\r\n}\r\n\r\n.modal-header {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n\tmargin-bottom: 35rpx;\r\n\tpadding-bottom: 25rpx;\r\n\tborder-bottom: 2rpx solid #F0F0F0;\r\n}\r\n\r\n.modal-title {\r\n\tfont-size: 38rpx;\r\n\tfont-weight: 700;\r\n\tcolor: #1890FF;\r\n}\r\n\r\n.modal-close {\r\n\tfont-size: 42rpx;\r\n\tcolor: #999;\r\n\tpadding: 15rpx;\r\n\tborder-radius: 50%;\r\n\ttransition: all 0.3s ease;\r\n\tbackground: #F8F9FA;\r\n\twidth: 60rpx;\r\n\theight: 60rpx;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n}\r\n\r\n.modal-close:active {\r\n\tbackground: #E6F3FF;\r\n\ttransform: scale(0.9);\r\n}\r\n\r\n.modal-body {\r\n\ttext-align: center;\r\n}\r\n\r\n.modal-text {\r\n\tdisplay: block;\r\n\tfont-size: 30rpx;\r\n\tcolor: #666;\r\n\tmargin-bottom: 25rpx;\r\n\tline-height: 1.6;\r\n}\r\n\r\n.feature-preview {\r\n\tmargin-top: 35rpx;\r\n\tpadding: 30rpx;\r\n\tbackground: #F8F9FA;\r\n\tborder-radius: 20rpx;\r\n\tborder: 2rpx solid #E6F3FF;\r\n}\r\n\r\n.feature-item {\r\n\tdisplay: block;\r\n\tfont-size: 28rpx;\r\n\tcolor: #333;\r\n\tmargin-bottom: 18rpx;\r\n\ttext-align: left;\r\n\tpadding-left: 25rpx;\r\n\tposition: relative;\r\n}\r\n\r\n.feature-item::before {\r\n\tcontent: 'âœ“';\r\n\tposition: absolute;\r\n\tleft: 0;\r\n\tcolor: #1890FF;\r\n\tfont-weight: bold;\r\n}\r\n\r\n.feature-item:last-child {\r\n\tmargin-bottom: 0;\r\n}\r\n\r\n/* å†å²è®°å½•é¢æ¿æ ·å¼ - ä¼˜åŒ–å */\r\n.history-panel {\r\n\tposition: fixed;\r\n\ttop: 0;\r\n\tright: -450rpx;\r\n\twidth: 450rpx;\r\n\theight: 100vh;\r\n\tbackground: white;\r\n\tbox-shadow: -8rpx 0 35rpx rgba(0, 0, 0, 0.15);\r\n\ttransition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1);\r\n\tz-index: 1000;\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n}\r\n\r\n.history-panel.active {\r\n\tright: 0;\r\n}\r\n\r\n.history-header {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n\tpadding: 35rpx 30rpx;\r\n\tborder-bottom: 2rpx solid #F0F0F0;\r\n\tbackground: linear-gradient(135deg, #E6F3FF 0%, #F5F9FF 100%);\r\n}\r\n\r\n.history-title {\r\n\tfont-size: 34rpx;\r\n\tfont-weight: 700;\r\n\tcolor: #1890FF;\r\n}\r\n\r\n.history-stats {\r\n\tdisplay: flex;\r\n\tgap: 20rpx;\r\n}\r\n\r\n.stat-item {\r\n\tfont-size: 24rpx;\r\n\tcolor: #666;\r\n\tbackground: rgba(255, 255, 255, 0.8);\r\n\tpadding: 8rpx 15rpx;\r\n\tborder-radius: 10rpx;\r\n}\r\n\r\n.history-close {\r\n\tfont-size: 38rpx;\r\n\tcolor: #999;\r\n\tpadding: 15rpx;\r\n\tborder-radius: 50%;\r\n\ttransition: all 0.3s ease;\r\n\tbackground: rgba(255, 255, 255, 0.8);\r\n\twidth: 60rpx;\r\n\theight: 60rpx;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n}\r\n\r\n.history-close:active {\r\n\tbackground: #E6F3FF;\r\n\ttransform: scale(0.9);\r\n}\r\n\r\n.history-list {\r\n\tflex: 1;\r\n\theight: calc(100vh - 140rpx);\r\n\tpadding: 25rpx;\r\n\toverflow-y: auto;\r\n}\r\n\r\n.history-item {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n\tpadding: 30rpx;\r\n\tmargin-bottom: 20rpx;\r\n\tbackground: #F8F9FA;\r\n\tborder-radius: 20rpx;\r\n\ttransition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n\tborder: 2rpx solid transparent;\r\n\tcursor: pointer;\r\n\tposition: relative;\r\n\toverflow: hidden;\r\n}\r\n\r\n.history-item::before {\r\n\tcontent: '';\r\n\tposition: absolute;\r\n\tleft: 0;\r\n\ttop: 0;\r\n\tbottom: 0;\r\n\twidth: 6rpx;\r\n\tbackground: linear-gradient(180deg, #1890FF, #40A9FF);\r\n\ttransform: scaleY(0);\r\n\ttransition: transform 0.3s ease;\r\n}\r\n\r\n.history-item.active {\r\n\tbackground: linear-gradient(135deg, #E6F3FF 0%, #D6EBFF 100%);\r\n\tborder-color: #1890FF;\r\n\ttransform: translateX(-10rpx);\r\n\tbox-shadow: 0 10rpx 30rpx rgba(24, 144, 255, 0.2);\r\n}\r\n\r\n.history-item.active::before {\r\n\ttransform: scaleY(1);\r\n}\r\n\r\n.history-item:active {\r\n\ttransform: scale(0.98);\r\n}\r\n\r\n.conversation-info {\r\n\tflex: 1;\r\n\tmargin-right: 20rpx;\r\n}\r\n\r\n.conversation-title {\r\n\tdisplay: block;\r\n\tfont-size: 30rpx;\r\n\tfont-weight: 700;\r\n\tcolor: #333;\r\n\tmargin-bottom: 12rpx;\r\n\tline-height: 1.3;\r\n}\r\n\r\n.conversation-meta {\r\n\tdisplay: block;\r\n\tfont-size: 24rpx;\r\n\tcolor: #666;\r\n\tline-height: 1.4;\r\n}\r\n\r\n.conversation-actions {\r\n\tdisplay: flex;\r\n\tgap: 15rpx;\r\n}\r\n\r\n.action-btn {\r\n\tfont-size: 26rpx;\r\n\tpadding: 12rpx;\r\n\tborder-radius: 10rpx;\r\n\ttransition: all 0.3s ease;\r\n\tbackground: rgba(255, 255, 255, 0.8);\r\n}\r\n\r\n.action-btn:active {\r\n\tbackground: rgba(0, 0, 0, 0.1);\r\n\ttransform: scale(0.9);\r\n}\r\n\r\n.delete-btn {\r\n\tcolor: #FF4D4F;\r\n}\r\n\r\n.edit-btn {\r\n\tcolor: #1890FF;\r\n}\r\n\r\n.empty-state {\r\n\ttext-align: center;\r\n\tpadding: 80rpx 30rpx;\r\n}\r\n\r\n.empty-icon {\r\n\tdisplay: block;\r\n\tfont-size: 90rpx;\r\n\tmargin-bottom: 25rpx;\r\n\topacity: 0.6;\r\n}\r\n\r\n.empty-text {\r\n\tdisplay: block;\r\n\tfont-size: 30rpx;\r\n\tcolor: #666;\r\n\tmargin-bottom: 15rpx;\r\n\tfont-weight: 600;\r\n}\r\n\r\n.empty-hint {\r\n\tdisplay: block;\r\n\tfont-size: 26rpx;\r\n\tcolor: #999;\r\n}\r\n\r\n/* é®ç½©å±‚æ ·å¼ - ä¼˜åŒ–å */\r\n.overlay {\r\n\tposition: fixed;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\tright: 0;\r\n\tbottom: 0;\r\n\tbackground: rgba(0, 0, 0, 0.6);\r\n\tz-index: 999;\r\n\tanimation: overlayFadeIn 0.3s ease;\r\n}\r\n\r\n@keyframes overlayFadeIn {\r\n\tfrom {\r\n\t\topacity: 0;\r\n\t}\r\n\tto {\r\n\t\topacity: 1;\r\n\t}\r\n}\r\n\r\n/* ç¼–è¾‘æ ‡é¢˜å¼¹çª—æ ·å¼ - ä¼˜åŒ–å */\r\n.title-input {\r\n\twidth: 100%;\r\n\theight: 90rpx;\r\n\tbackground: #F8F9FA;\r\n\tborder: 2rpx solid #E6F3FF;\r\n\tborder-radius: 20rpx;\r\n\tpadding: 0 30rpx;\r\n\tfont-size: 30rpx;\r\n\tmargin-bottom: 35rpx;\r\n\ttransition: all 0.3s ease;\r\n}\r\n\r\n.title-input:focus {\r\n\tborder-color: #1890FF;\r\n\tbox-shadow: 0 0 0 4rpx rgba(24, 144, 255, 0.1);\r\n}\r\n\r\n.modal-actions {\r\n\tdisplay: flex;\r\n\tgap: 25rpx;\r\n\tjustify-content: center;\r\n}\r\n\r\n.btn-cancel, .btn-confirm {\r\n\tpadding: 25rpx 45rpx;\r\n\tborder-radius: 20rpx;\r\n\tfont-size: 30rpx;\r\n\tfont-weight: 600;\r\n\tborder: none;\r\n\ttransition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n\tmin-width: 120rpx;\r\n}\r\n\r\n.btn-cancel {\r\n\tbackground: #F8F9FA;\r\n\tcolor: #666;\r\n\tbox-shadow: 0 4rpx 15rpx rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.btn-cancel:active {\r\n\tbackground: #E6F3FF;\r\n\ttransform: scale(0.95);\r\n}\r\n\r\n.btn-confirm {\r\n\tbackground: linear-gradient(135deg, #1890FF 0%, #40A9FF 100%);\r\n\tcolor: white;\r\n\tbox-shadow: 0 6rpx 20rpx rgba(24, 144, 255, 0.3);\r\n}\r\n\r\n.btn-confirm:active {\r\n\ttransform: scale(0.95);\r\n\tbox-shadow: 0 4rpx 12rpx rgba(24, 144, 255, 0.4);\r\n}\r\n\r\n/* åŠ è½½åŠ¨ç”»æ ·å¼ - ä¼˜åŒ–å */\r\n.loading-dots {\r\n\tdisplay: flex;\r\n\tjustify-content: center;\r\n\talign-items: center;\r\n\tgap: 10rpx;\r\n\tpadding: 20rpx;\r\n}\r\n\r\n.dot {\r\n\tfont-size: 45rpx;\r\n\tcolor: #1890FF;\r\n\tanimation: dot-bounce 1.4s infinite ease-in-out both;\r\n\tfilter: drop-shadow(0 2rpx 4rpx rgba(24, 144, 255, 0.3));\r\n}\r\n\r\n.dot:nth-child(1) {\r\n\tanimation-delay: -0.32s;\r\n}\r\n\r\n.dot:nth-child(2) {\r\n\tanimation-delay: -0.16s;\r\n}\r\n\r\n@keyframes dot-bounce {\r\n\t0%, 80%, 100% {\r\n\t\ttransform: scale(0.5);\r\n\t\topacity: 0.5;\r\n\t}\r\n\t40% {\r\n\t\ttransform: scale(1.2);\r\n\t\topacity: 1;\r\n\t}\r\n}\r\n\r\n/* å“åº”å¼è°ƒæ•´ - ä¼˜åŒ–å */\r\n@media (max-width: 750rpx) {\r\n\t.ai-page {\r\n\t\tpadding: 15rpx;\r\n\t}\r\n\t\r\n\t.top-bar {\r\n\t\tflex-direction: column;\r\n\t\tgap: 25rpx;\r\n\t\tpadding: 20rpx 0;\r\n\t}\r\n\t\r\n\t.virtual-human-btn, .current-settings, .new-conversation-btn, .history-btn {\r\n\t\tmin-height: 70rpx;\r\n\t\tpadding: 15rpx 25rpx;\r\n\t}\r\n\t\r\n\t.current-settings {\r\n\t\tmargin: 0;\r\n\t\torder: 1;\r\n\t\twidth: 100%;\r\n\t}\r\n\t\r\n\t.conversation-actions {\r\n\t\tjustify-content: space-between;\r\n\t\twidth: 100%;\r\n\t\torder: 2;\r\n\t}\r\n\t\r\n\t.role-section, .style-section {\r\n\t\tpadding: 25rpx;\r\n\t\tmargin-bottom: 25rpx;\r\n\t}\r\n\t\r\n\t.role-item {\r\n\t\tmin-width: 170rpx;\r\n\t\tpadding: 25rpx 30rpx;\r\n\t}\r\n\t\r\n\t.style-tag {\r\n\t\tmin-width: 150rpx;\r\n\t\tpadding: 20rpx 25rpx;\r\n\t}\r\n\t\r\n\t.chat-container {\r\n\t\tpadding: 25rpx;\r\n\t\theight: calc(100vh - 550rpx);\r\n\t}\r\n\t\r\n\t.avatar {\r\n\t\twidth: 75rpx;\r\n\t\theight: 75rpx;\r\n\t\tfont-size: 35rpx;\r\n\t\tmargin: 0 15rpx;\r\n\t}\r\n\t\r\n\t.content {\r\n\t\tmax-width: 80%;\r\n\t\tpadding: 20rpx;\r\n\t\tfont-size: 28rpx;\r\n\t}\r\n\t\r\n\t.input-area {\r\n\t\tpadding: 15rpx 20rpx;\r\n\t}\r\n\t\r\n\t.input {\r\n\t\theight: 80rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tpadding: 0 25rpx;\r\n\t}\r\n\t\r\n\t.send-btn {\r\n\t\twidth: 120rpx;\r\n\t\theight: 80rpx;\r\n\t\tfont-size: 28rpx;\r\n\t}\r\n\t\r\n\t.history-panel {\r\n\t\twidth: 85%;\r\n\t\tright: -85%;\r\n\t}\r\n\t\r\n\t.modal-content {\r\n\t\tmargin: 30rpx;\r\n\t\tpadding: 35rpx;\r\n\t}\r\n\t\r\n\t.feature-item {\r\n\t\tfont-size: 26rpx;\r\n\t}\r\n}\r\n</style>","import MiniProgramPage from 'D:/workspace/PBL2/HeartHarborx/pages/ai/ai.vue'\nwx.createPage(MiniProgramPage)"],"names":["conversationService","uni","error"],"mappings":"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"}